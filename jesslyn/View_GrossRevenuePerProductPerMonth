create or replace view JESSLYN.PUBLIC.JESSLYN_GROSSREVENUE_PERPRODUCT_PERMONTH(
	ORDER_MONTH,
	PRODUCT_NAME,
	TOTAL_GROSS_REVENUE
) as SELECT 
ORDER_MONTH, 
PRODUCT_NAME, 
SUM(GROSS_REVENUE) TOTAL_GROSS_REVENUE 
FROM (
    SELECT (1-B.DISCOUNT)*B.UNIT_PRICE*B.QUANTITY GROSS_REVENUE,
    SUBSTR(ORDER_DATE,1,7) ORDER_MONTH,
    C.PRODUCT_NAME 
    FROM ORDERS A
    LEFT JOIN ORDER_DETAILS B
    ON A.ORDER_ID = B.ORDER_ID
    LEFT JOIN PRODUCTS C
    ON B.PRODUCT_ID = C.PRODUCT_ID
    )
GROUP BY ORDER_MONTH, PRODUCT_NAME
ORDER BY ORDER_MONTH;