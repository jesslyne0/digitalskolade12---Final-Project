create or replace view JESSLYN.PUBLIC.JESSLYN_DAILY_GROSS_REVENUE(
	ORDER_DATE,
	TOTAL_GROSS_REVENUE
) as
SELECT ORDER_DATE, SUM(GROSS_REVENUE) TOTAL_GROSS_REVENUE FROM (
    SELECT (1-B.DISCOUNT)*B.UNIT_PRICE*B.QUANTITY GROSS_REVENUE, A.ORDER_DATE FROM ORDERS A
    LEFT JOIN ORDER_DETAILS B
    ON A.ORDER_ID = B.ORDER_ID
)
GROUP BY ORDER_DATE
ORDER BY ORDER_DATE;